<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Appointments | MediCare India</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --primary: #0056b3; --bg: #f8f9fa; --text: #2d3436; --white: #fff; }
        body { font-family: 'Poppins', sans-serif; background: var(--bg); color: var(--text); margin: 0; }
        .container { max-width: 1000px; margin: 0 auto; padding: 20px; }
        
        nav { background: white; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .nav-links { display: flex; gap: 20px; list-style: none; }
        a { text-decoration: none; color: inherit; }

        .tabs { display: flex; gap: 20px; margin-bottom: 30px; border-bottom: 2px solid #ddd; margin-top: 30px; }
        .tab-btn { padding: 10px 20px; background: none; border: none; font-size: 1.1rem; cursor: pointer; opacity: 0.6; }
        .tab-btn.active { border-bottom: 3px solid var(--primary); opacity: 1; font-weight: 600; color: var(--primary); }

        .content-section { display: none; animation: fadein 0.3s; }
        .content-section.active { display: block; }
        @keyframes fadein { from { opacity: 0; } to { opacity: 1; } }

        .booking-form { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; margin-bottom: 5px; font-weight: 500; }
        .input-group input, .input-group select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; }
        .btn-submit { background: var(--primary); color: white; padding: 12px 30px; border: none; border-radius: 5px; width: 100%; cursor: pointer; font-size: 1rem; margin-top: 10px; }

        .apt-card { background: white; padding: 20px; margin-bottom: 15px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; border-left: 5px solid var(--primary); box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .apt-status.upcoming { color: orange; font-weight: bold; }
        .apt-status.completed { color: green; font-weight: bold; }
        .apt-status.cancelled { color: red; font-weight: bold; }
        .cancel-btn { background: #ff6b6b; color: white; border: none; padding: 5px 15px; border-radius: 4px; cursor: pointer; }
    </style>
</head>
<body>

    <nav>
        <h2 style="color:#0056b3;"><i class="fas fa-heartbeat"></i> MediCare</h2>
        <ul class="nav-links">
            <li><a href="index.html">Home</a></li>
            <li><a href="doctors.html">Doctors</a></li>
            <li><a href="availability.html">Check Availability</a></li>
            <li><a href="appointments.html?view=history" style="color: #0056b3; font-weight: bold;">My Appointments</a></li>
        </ul>
    </nav>

    <div class="container">
        <div class="tabs">
            <button id="tab-book" class="tab-btn active" onclick="switchTab('book')">Book New Appointment</button>
            <button id="tab-history" class="tab-btn" onclick="switchTab('history')">My History & Status</button>
        </div>

        <div id="book" class="content-section active">
            <div class="booking-form">
                <h3><i class="fas fa-calendar-plus"></i> Schedule a Visit</h3>
                <form onsubmit="event.preventDefault(); bookAppointment();">
                    <div class="form-grid">
                        <div class="input-group">
                            <label>Department</label>
                            <select id="dept">
                                <option>Cardiology</option>
                                <option>Neurology</option>
                                <option>Pediatrics</option>
                                <option>Orthopedics</option>
                                <option>Gynecology</option>
                                <option>General Medicine</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label>Select Doctor</label>
                            <select id="doc">
                                <option>Dr. Rajesh Gupta (Cardiology)</option>
                                <option>Dr. Priya Desai (Pediatrics)</option>
                                <option>Dr. Amit Verma (Neurology)</option>
                                <option>Dr. Vikram Singh (Orthopedics)</option>
                                <option>Dr. Neha Kapoor (Gynecology)</option>
                                <option>Dr. Suresh Menon (General Medicine)</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label>Date</label>
                            <input type="date" id="aptDate" required>
                        </div>
                        <div class="input-group">
                            <label>Time Slot</label>
                            <select id="aptTime">
                                <option>09:00 AM</option>
                                <option>10:00 AM</option>
                                <option>11:00 AM</option>
                                <option>02:00 PM</option>
                                <option>04:00 PM</option>
                            </select>
                        </div>
                    </div>
                    <div class="input-group"><label>Reason</label><input type="text" placeholder="e.g. Fever, Chest Pain" required></div>
                    <button class="btn-submit">Confirm Booking</button>
                </form>
            </div>
        </div>

        <div id="history" class="content-section">
            <h3 style="color: var(--primary); margin-bottom: 20px;">Upcoming Appointments</h3>
            <div id="upcoming-list">
                <div class="apt-card" id="apt-1">
                    <div><h4>Dr. Priya Desai (Pediatrician)</h4><p><small>25th Nov, 2025 | 10:00 AM</small></p><span class="apt-status upcoming">● Confirmed</span></div>
                    <button class="cancel-btn" onclick="cancelAppointment('apt-1')">Cancel Appt</button>
                </div>
                <div class="apt-card" id="apt-2">
                    <div><h4>Dr. Vikram Singh (Orthopedics)</h4><p><small>28th Nov, 2025 | 04:30 PM</small></p><span class="apt-status upcoming">● Confirmed</span></div>
                    <button class="cancel-btn" onclick="cancelAppointment('apt-2')">Cancel Appt</button>
                </div>
            </div>
            
            <h3 style="color: #666; margin-top: 40px;">Past History</h3>
            <div class="apt-card" style="border-left-color: green; background: #f9fff9;">
                <div><h4>Dr. Rajesh Gupta (Cardiologist)</h4><p><small>10th Oct, 2025 | 11:00 AM</small></p><span class="apt-status completed">● Completed</span></div>
                <button style="border:1px solid #ccc; background:none; padding:5px;">Prescription</button>
            </div>
            <div class="apt-card" style="border-left-color: red; opacity: 0.7;">
                <div><h4>Dr. Neha Kapoor (Gynecologist)</h4><p><small>1st Aug, 2025 | 02:00 PM</small></p><span class="apt-status cancelled">● Cancelled</span></div>
            </div>
        </div>
    </div>

    <script>
        function switchTab(tabName) {
            document.querySelectorAll('.content-section').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            document.getElementById('tab-' + tabName).classList.add('active');
        }

        window.onload = function() {
            const urlParams = new URLSearchParams(window.location.search);
            if(urlParams.get('view') === 'history') {
                switchTab('history');
            }
            // Set min date to today
            document.getElementById('aptDate').min = new Date().toISOString().split("T")[0];
        }

        function cancelAppointment(id) {
            if(confirm("Are you sure you want to cancel this appointment?")) {
                const card = document.getElementById(id);
                if(card) {
                    card.querySelector('.apt-status').innerText = "● Cancelled";
                    card.querySelector('.apt-status').className = "apt-status cancelled";
                    card.style.borderLeftColor = "red";
                    card.querySelector('.cancel-btn').style.display = 'none';
                    alert("Appointment Cancelled Successfully.");
                }
            }
        }

        function bookAppointment() {
            // 1. Get Form Values
            const doc = document.getElementById('doc').value;
            const date = document.getElementById('aptDate').value;
            const time = document.getElementById('aptTime').value;

            if(!date) { alert("Please select a date"); return; }

            // 2. Generate Unique ID (Timestamp based)
            const uniqueId = 'apt-' + Date.now();

            // 3. Create HTML with unique ID and onclick event
            const html = `
                <div class="apt-card" id="${uniqueId}" style="border-left-color:orange;">
                    <div>
                        <h4>${doc}</h4>
                        <p><small>${date} | ${time}</small></p>
                        <span class="apt-status upcoming">● Upcoming (New)</span>
                    </div>
                    <button class="cancel-btn" onclick="cancelAppointment('${uniqueId}')">Cancel Appt</button>
                </div>`;

            // 4. Prepend to list
            const list = document.getElementById('upcoming-list');
            list.innerHTML = html + list.innerHTML;
            
            alert("Booking Confirmed! View it in your history.");
            switchTab('history');
        }
    </script>
</body>
</html>